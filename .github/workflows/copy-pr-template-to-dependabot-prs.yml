name: Copy PR template to Dependabot PRs

on:
  pull_request_target:
    types: [opened]

permissions:
  contents: read
  pull-requests: write

jobs:
  copy_pr_template:
    name: Copy PR template to Dependabot PR
    runs-on: ubuntu-latest
    if: github.actor == 'dependabot[bot]'
    steps:
      - uses: actions/checkout@08eba0b27e820071cde6df949e0beb9ba4906955 # v4.3.0

      - name: Post PR template as a comment
        uses: actions/github-script@60a0d83039c74a4aee543508d2ffcb1c3799cdea # v7.0.1
        with:
          script: |
            const fs = require('fs')

            const body = [
              "pull_request_template.md",
              ".github/pull_request_template.md",
              "docs/pull_request_template.md",
            ].
              filter(path => fs.existsSync(path)).
              map(path => fs.readFileSync(path)).
              join("\n")

            if (body !== "") {
              github.rest.issues.createComment({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                body
              })
            }
